<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bioskop Online ‚Äî Demo Aplikasi</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">
        <div class="logo">BI</div>
        <div>
          <h1>Bioskop K6</h1>
          <div style="font-size:12px;color:var(--muted)">Demo</div>
        </div>
      </div>
      <nav>
        <button id="nav-home" class="active" onclick="show('home')">Beranda</button>
        <button id="nav-detail" onclick="show('detail')">Detail Film</button>
        <button id="nav-kursi" onclick="show('kursi')">Pilih Kursi</button>
        <button id="nav-jadwal" onclick="show('jadwal')">Jadwal & Lokasi</button>
        <button id="nav-bayar" onclick="show('bayar')">Pembayaran</button>
      </nav>
    </header>

    <main class="screen" style="margin-top:18px">
      <section id="home" class="page active">
        <h2 style="margin:0 0 12px">Sedang Tayang</h2>
        <div class="grid" id="movieList"></div>
      </section>

      <section id="detail" class="page">
        <div class="detail">
          <div class="card">
            <div class="poster" id="detailPoster">Poster</div>
            <div class="chips" style="margin-top:8px">
              <div class="chip" id="detailDurasi">120m</div>
              <div class="chip" id="detailGenre">Aksi</div>
            </div>
          </div>
          <div class="card">
            <h2 id="detailTitle">Judul Film</h2>
            <div style="color:var(--muted);margin-bottom:8px" id="detailSub">2025 ‚Ä¢ Sutradara: ‚Äî</div>
            <p id="detailSynopsis" style="color:var(--muted)">Sinopsis singkat film akan tampil di sini.</p>
            <div style="display:flex;gap:8px;margin-top:12px">
              <button class="btn" id="btnTrailer">Tonton Trailer</button>
              <button class="btn ghost" id="btnPesan">Pesan Tiket</button>
            </div>
          </div>
        </div>
      </section>

      <section id="kursi" class="page">
        <div style="display:flex;gap:18px;flex-direction:column">
          <div class="seat-area card">
            <div style="text-align:center;color:var(--muted);font-size:13px">Layar</div>
            <div class="screen-label"></div>
            <div class="seat-grid" id="seatGrid"></div>
            <div class="legend">
              <div class="legend-item"><div class="box" style="background:var(--accent)"></div> Dipilih</div>
              <div class="legend-item"><div class="box seat-style"></div> Kosong</div>
              <div class="legend-item"><div class="box taken-style"></div> Terisi</div>
            </div>
          </div>
          <div style="display:flex;gap:10px;justify-content:flex-end">
            <button class="btn ghost" onclick="show('detail')">Kembali</button>
            <button class="btn" id="toJadwal">Lanjut ke Jadwal</button>
          </div>
        </div>
      </section>

      <section id="jadwal" class="page">
        <div class="content-wrapper">
          <div class="form-section">
            <label for="selectCinema">Pilih Bioskop</label>
            <select id="selectCinema" style="width:100%"><option>CGV Grand Mall</option><option>XXI Plaza</option></select>
            <label for="inputDate">Pilih Tanggal</label>
            <input type="date" id="inputDate" style="width:100%" />
            <label>Pilih Jam</label>
            <div class="time-list" id="timeList"></div>
          </div>
          <div class="summary-section">
            <div class="summary">
              <h3>Ringkasan</h3>
              <div class="summary-box" id="summaryBox">Pilih kursi terlebih dahulu.</div>
              <div class="total-price">
                <div>Total</div>
                <div id="totalPrice">Rp 0</div>
              </div>
              <div class="nav-buttons">
                <button class="btn ghost" onclick="show('kursi')">Kembali</button>
                <button class="btn" id="toBayar">Lanjut Bayar</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="bayar" class="page">
        <div class="content-wrapper">
          <div class="form-section">
            <h3>Metode Pembayaran</h3>
            <select id="paymentMethod" style="width:100%"><option>Transfer Bank</option><option>E-Wallet</option></select>
            <label for="buyerName">Nama Pemesan</label>
            <input id="buyerName" placeholder="Nama lengkap" style="width:100%" />
            <label for="buyerEmail">Email</label>
            <input id="buyerEmail" placeholder="email@domain.com" style="width:100%" />
            <label for="buyerPhone">No. HP</label>
            <input id="buyerPhone" placeholder="0812xxxx" style="width:100%" />
            <div class="nav-buttons" style="margin-top:16px">
              <button class="btn ghost" onclick="show('jadwal')">Kembali</button>
              <button class="btn" id="payNow">Bayar Sekarang</button>
            </div>
          </div>
          <div class="summary-section">
            <div class="summary">
              <h3>Ringkasan Pesanan</h3>
              <div id="orderSummary" class="summary-box">Tidak ada data.</div>
            </div>
          </div>
        </div>
      </section>

      <section id="success" class="page">
        <div class="ticket-wrapper">
          <h2>üéüÔ∏è Tiket Berhasil Dipesan!</h2>
          <p>Tunjukkan kode di bawah saat masuk bioskop.</p>
          <div id="ticketCard" class="ticket-card"></div>
          <button class="btn" onclick="show('home')">Kembali ke Beranda</button>
        </div>
      </section>

    </main>

    <footer>¬© 2025 ‚Ä¢ Demo - Kelompok 6</footer>
  </div>

  <script>
    // --- DATA SAMPEL ---
    const movies = [
      {id:1, title:'Senjata 2', durasi:'2j 20m', genre:'Aksi', year:2025, synopsis:'Aksi penuh tensi, pelarian dari kejaran organisasi gelap di tengah kota metropolitan.'},
      {id:2, title:'Malam Merah', durasi:'1j 55m', genre:'Thriller', year:2025, synopsis:'Ketegangan di sebuah vila terpencil saat sekelompok teman mengungkap rahasia kelam.'},
      {id:3, title:'Pelangi Kita', durasi:'2j 5m', genre:'Drama', year:2024, synopsis:'Kisah hangat tentang persahabatan, mimpi, dan pilihan sulit dalam perjalanan hidup.'}
    ];
    const pricePerSeat = 50000;

    // --- NAVIGASI ---
    function show(page){
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(page).classList.add('active');
      document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
      const navMap = {home:'nav-home', detail:'nav-detail', kursi:'nav-kursi', jadwal:'nav-jadwal', bayar:'nav-bayar'};
      if(navMap[page]) document.getElementById(navMap[page]).classList.add('active');
      
      // Memperbarui konten dinamis saat halaman ditampilkan
      if(page === 'detail') renderDetail(selectedMovieId);
      if(page === 'kursi') renderSeats();
      if(page === 'jadwal') updateSummaryBox();
      if(page === 'bayar') renderOrderSummary();
    }

    // --- RENDER DAFTAR FILM ---
    const movieList = document.getElementById('movieList');
    movies.forEach(m => {
      const el = document.createElement('div'); el.className = 'movie';
      el.innerHTML = `<div class="poster">${m.title}</div><h3>${m.title}</h3><div class="meta">${m.genre} ‚Ä¢ ${m.durasi}</div><div style="height:8px"></div><button class='btn' onclick='openDetail(${m.id})'>Lihat Detail</button>`;
      movieList.appendChild(el);
    });

    let selectedMovieId = movies[0].id;
    function openDetail(id){ selectedMovieId = id; show('detail'); }

    // --- RENDER DETAIL FILM ---
    function renderDetail(id){
      const m = movies.find(x => x.id === id);
      document.getElementById('detailTitle').textContent = m.title;
      document.getElementById('detailDurasi').textContent = m.durasi;
      document.getElementById('detailGenre').textContent = m.genre;
      document.getElementById('detailSynopsis').textContent = m.synopsis;
      document.getElementById('detailPoster').textContent = m.title;
      document.getElementById('detailSub').textContent = `${m.year} ‚Ä¢ Sutradara: John Doe`;
    }
    document.getElementById('btnPesan').addEventListener('click', () => { show('kursi') });

    // --- RENDER KURSI ---
    const seatGrid = document.getElementById('seatGrid');
    let takenSeats = [3, 4, 12, 13, 22, 23, 30, 31, 38, 39];
    let selectedSeats = JSON.parse(localStorage.getItem('selectedSeats') || '[]');

    function renderSeats(){
      seatGrid.innerHTML = '';
      for(let i = 1; i <= 40; i++){
        const s = document.createElement('div');
        s.className = 'seat';
        s.textContent = i;
        if(takenSeats.includes(i)) s.classList.add('taken');
        if(selectedSeats.includes(i)) s.classList.add('selected');
        s.addEventListener('click', () => {
          if(s.classList.contains('taken')) return;
          s.classList.toggle('selected');
          if(s.classList.contains('selected')) {
            selectedSeats.push(i);
          } else {
            selectedSeats = selectedSeats.filter(x => x !== i);
          }
          localStorage.setItem('selectedSeats', JSON.stringify(selectedSeats));
        });
        seatGrid.appendChild(s);
      }
    }
    document.getElementById('toJadwal').addEventListener('click', () => {
      if(selectedSeats.length === 0){ alert('Pilih minimal satu kursi.'); return; }
      show('jadwal');
    });

    // --- RENDER JAM TAYANG ---
    const times = ['10:00', '13:00', '16:00', '19:00', '21:30'];
    const timeList = document.getElementById('timeList');
    let selectedTime = localStorage.getItem('selectedTime') || null;

    function renderTimes(){
      timeList.innerHTML = '';
      times.forEach(t => {
        const b = document.createElement('button');
        b.className = 'btn ghost';
        b.textContent = t;
        b.onclick = () => {
          selectedTime = t;
          localStorage.setItem('selectedTime', t);
          updateTimeButtons();
          updateSummaryBox();
        };
        timeList.appendChild(b);
      });
      updateTimeButtons();
    }
    function updateTimeButtons(){
      Array.from(timeList.children).forEach(b => {
        if(b.textContent === selectedTime) {
          b.classList.add('active');
        } else {
          b.classList.remove('active');
        }
      });
    }

    // --- UPDATE RINGKASAN DI HALAMAN JADWAL ---
    function updateSummaryBox(){
      const box = document.getElementById('summaryBox');
      const totalEl = document.getElementById('totalPrice');
      const seats = JSON.parse(localStorage.getItem('selectedSeats') || '[]');
      if(!seats || seats.length === 0){
        box.textContent = 'Pilih kursi terlebih dahulu.';
        totalEl.textContent = 'Rp 0';
        return;
      }
      const total = seats.length * pricePerSeat;
      box.innerHTML = `<b>${movies.find(m => m.id === selectedMovieId).title}</b><br>Kursi: ${seats.join(', ')}<br>Jam: ${selectedTime || '-'}<br>Bioskop: ${document.getElementById('selectCinema').value}`;
      totalEl.textContent = `Rp ${total.toLocaleString('id-ID')}`;
    }

    // --- TOMBOL LANJUT KE PEMBAYARAN ---
    document.getElementById('toBayar').addEventListener('click', () => {
      const date = document.getElementById('inputDate').value;
      if(!date){ alert('Pilih tanggal terlebih dahulu.'); return; }
      if(!selectedTime){ alert('Pilih jam tayang.'); return; }
      const jadwal = {cinema: document.getElementById('selectCinema').value, date, time: selectedTime};
      localStorage.setItem('jadwal', JSON.stringify(jadwal));
      show('bayar');
    });

    // --- RENDER RINGKASAN PESANAN DI HALAMAN BAYAR ---
    function renderOrderSummary(){
      const seats = JSON.parse(localStorage.getItem('selectedSeats') || '[]');
      const jadwal = JSON.parse(localStorage.getItem('jadwal') || '{}');
      const total = seats.length * pricePerSeat;
      document.getElementById('orderSummary').innerHTML = `<b>${movies.find(m => m.id === selectedMovieId).title}</b><br>Kursi: ${seats.join(', ')}<br>Bioskop: ${jadwal.cinema || '-'}<br>Tanggal: ${jadwal.date || '-'}<br>Jam: ${jadwal.time || '-'}<br><hr style="border-color:rgba(255,255,255,0.05); margin: 8px 0;"><strong>Total: Rp ${total.toLocaleString('id-ID')}</strong>`;
    }

    // --- TOMBOL BAYAR SEKARANG ---
    document.getElementById('payNow').addEventListener('click', () => {
      const name = document.getElementById('buyerName').value.trim();
      const email = document.getElementById('buyerEmail').value.trim();
      const phone = document.getElementById('buyerPhone').value.trim();
      if(!name || !email || !phone){ alert('Harap isi semua data pemesan.'); return; }
      const seats = JSON.parse(localStorage.getItem('selectedSeats') || '[]');
      const jadwal = JSON.parse(localStorage.getItem('jadwal') || '{}');
      const order = {id: 'TKT' + Date.now(), movie: movies.find(m => m.id === selectedMovieId).title, seats, jadwal, name, email, phone, total: seats.length * pricePerSeat};
      localStorage.setItem('lastOrder', JSON.stringify(order));
      show('success');
      renderTicket(order);
      // Bersihkan pilihan setelah berhasil
      seats.forEach(s => takenSeats.push(s)); // Simulasikan kursi menjadi terisi
      selectedSeats = [];
      localStorage.removeItem('selectedSeats');
      localStorage.removeItem('selectedTime');
    });

    // --- RENDER E-TIKET ---
    function renderTicket(order){
      const el = document.getElementById('ticketCard');
      el.innerHTML = `<strong>${order.movie}</strong><br>ID Pesanan: ${order.id}<br>Nama: ${order.name}<br>Kursi: ${order.seats.join(', ')}<br>Lokasi: ${order.jadwal.cinema}<br>Waktu: ${order.jadwal.date}, ${order.jadwal.time}<br><div class="total-price" style="margin-top:10px; justify-content:space-between;"><span>Total Bayar</span> <strong>Rp ${order.total.toLocaleString('id-ID')}</strong></div>`;
    }

    // --- INISIALISASI ---
    document.addEventListener('DOMContentLoaded', () => {
      renderTimes();
      show('home');
      // Tambahkan listener untuk memperbarui ringkasan saat ada perubahan
      document.getElementById('selectCinema').addEventListener('change', updateSummaryBox);
    });
  </script>
</body>
</html>